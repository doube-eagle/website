<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Double Eagle Ranch</title>
  <meta name="description"
    content="Community info for Double Eagle Ranch in Bastrop County, Texas: board, committees, and contact information." />
  <meta property="og:title" content="Double Eagle Ranch — Community Information" />
  <meta property="og:description" content="Official community information For Double Eagle Ranch residents." />
  <meta name="theme-color" content="#256f4a" />

  <!-- Light mode -->
  <link rel="icon" href="assets/favicon-32.png" sizes="32x32" media="(prefers-color-scheme: light)">
  <link rel="icon" href="assets/favicon-16.png" sizes="16x16" media="(prefers-color-scheme: light)">

  <!-- Fallback (for older browsers) -->
  <link rel="icon" href="assets/favicon-32.png" sizes="32x32">
  <link rel="icon" href="assets/favicon-16.png" sizes="16x16">

  <!-- ICO catch-all for legacy -->
  <link rel="icon" href="assets/favicon.ico" sizes="any">

  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header id="main-header">
    <div class="portal-container">
      <div class="portal-inner">
        <nav class="menu">
          <a id="menu-main" href="#main">Main</a>
          <a id="menu-calendar" href="#calendar">Calendar</a>
        </nav>
        <a class="portal-btn" href="https://portal.pamcotx.com/login" target="_blank" rel="noopener">PAMco Resident
          Portal</a>
      </div>
    </div>
  </header>

  <main id="page-main">
    <section id="about">
      <h1>Double Eagle Ranch</h1>
      <p>For documents and payment, please visit <a href="https://portal.pamcotx.com/login" target="_blank"
          rel="noopener">PAMco's Resident Portal</a>.
      </p>
      <p>Have a general suggestion? Please send us an email at <a
          href="mailto:suggestions@double-eagle.us">suggestions@double-eagle.us</a>.
      </p>
    </section>

    <section id="board">
      <h2>Board of Directors</h2>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Position</th>
            <th>Term Ends</th>
          </tr>
        </thead>
        <tbody id="board-rows"></tbody>
      </table>
      <p>Have a question or comment for the Board? Please send us an email at <a
          href="mailto:board@double-eagle.us">board@double-eagle.us</a>.</p>
    </section>

    <section id="committees">
      <h2>Committees</h2>

      <div class="committee-block">
        <h3>Architectural Review Committee (ARC)</h3>
        <p>Preserve community character through <strong>design review</strong> that ensures quality
          and <strong>collaboration</strong> that makes the approval process simple and fair for
          everyone.</p>
        <p>Submit requests through <a href="https://portal.pamcotx.com/login" target="_blank" rel="noopener">PAMco's
            Resident Portal</a></p>
        <p>Email: <a href="mailto:arc@double-eagle.us">arc@double-eagle.us</a></p>
        <table class="no-mobile-stack">
          <thead>
            <tr>
              <th>Members</th>
            </tr>
          </thead>
          <tbody id="committee-arc"></tbody>
        </table>
      </div>

      <div class="committee-block">
        <h3>Social Committee</h3>
        <p>Create community engagement through <strong>events</strong> that bring neighbors together
          and <strong>communication</strong> that keeps residents informed and connected.</p>
        <p>Email: <a href="mailto:social@double-eagle.us">social@double-eagle.us</a></p>
        <table class="no-mobile-stack">
          <thead>
            <tr>
              <th>Members</th>
            </tr>
          </thead>
          <tbody id="committee-social"></tbody>
        </table>
      </div>

      <div class="committee-block">
        <h3>Park & Landscape Committee</h3>
        <p>Enhance neighborhood life through <strong>landscaping</strong> that beautifies our shared
          spaces and <strong>projects</strong> that bring neighbors together outdoors.</p>
        <p>Email: <a href="mailto:parks@double-eagle.us">parks@double-eagle.us</a></p>
        <table class="no-mobile-stack">
          <thead>
            <tr>
              <th>Members</th>
            </tr>
          </thead>
          <tbody>
          <tbody id="committee-parks"></tbody>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <main id="page-calendar" style="display:none">
    <div class="calendar-embed">
      <div id="month-calendar"><iframe
          src="https://calendar.google.com/calendar/embed?wkst=1&ctz=America%2FChicago&showTz=0&showTitle=0&showTabs=0&showCalendars=0&src=ZmJjMGQwMjBmYjMyY2NkMTViMmQ5NTJlMTA0YjNhYzkxOThkMjI2MWY5MzE3YzhiN2VjNWRlYmNjOGMzNDBiMEBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&color=%239e69af"
          frameborder="0" scrolling="no">
        </iframe>
      </div>
      <div id="schedule-calendar">
        <iframe
          src="https://calendar.google.com/calendar/embed?wkst=1&ctz=America%2FChicago&mode=AGENDA&showTabs=0&showCalendars=0&showPrint=0&src=ZmJjMGQwMjBmYjMyY2NkMTViMmQ5NTJlMTA0YjNhYzkxOThkMjI2MWY5MzE3YzhiN2VjNWRlYmNjOGMzNDBiMEBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&color=%239e69af"
          style="border:solid 1px #777" frameborder="0" scrolling="no"></iframe>
      </div>
    </div>

    <div class="ical-card" role="region" aria-label="Calendar link">
      <div class="ical-row" style="margin-bottom:.5rem;">
        <p class="ical-label">Add this calendar to your app:</p>
        <button class="btn-copy" type="button" id="copy-ical">
          <svg class="copy-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M16 3H5a2 2 0 0 0-2 2v11" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            <rect x="7" y="7" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2" />
          </svg>
          Copy link
        </button>
        <span class="copied" id="copied-msg" aria-live="polite">Copied!</span>
      </div>
      <div class="link-box" id="calendar-link">
        https://calendar.google.com/calendar/ical/fbc0d020fb32ccd15b2d952e104b3ac9198d2261f9317c8b7ec5debcc8c340b0%40group.calendar.google.com/public/basic.ics
      </div>
      <small style="display:block; margin-top:.5rem; color:#475569;">Paste into any calendar app that accepts
        a web calendar link.</small>
    </div>
  </main>

  <main id="page-banner" style="display:none; text-align:center; padding:2rem;">
    <p>This lovely banner image came from one of our residents, <a href="https://www.tinaautenphotography.com/"
        target="_blank">Tina Auten</a>.</p>
    <a href="https://www.tinaautenphotography.com" target="_blank" style="display:inline-block;">
      <img src="assets/banner.jpg" alt="Banner Image"
        style="max-width:100%; height:auto; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.2);">
    </a>
  </main>


  <footer id="site-footer">
    <p>© <span id="year"></span> Double Eagle Ranch</p>
  </footer>

  <script>
    // Page init
    document.getElementById('year').textContent = new Date().getFullYear();

    function setRoute() {
      const hash = location.hash;
      const isMain = !hash || hash === '#main';
      const isCal = hash === '#calendar';
      const isBanner = hash === '#banner';

      // Show or hide pages
      document.getElementById('page-main').style.display = isMain ? 'block' : 'none';
      document.getElementById('page-calendar').style.display = isCal ? 'block' : 'none';
      document.getElementById('page-banner').style.display = isBanner ? 'block' : 'none';

      // Update menu active states
      document.getElementById('menu-main').classList.toggle('active', isMain);
      document.getElementById('menu-calendar').classList.toggle('active', isCal);
    }
    window.addEventListener('hashchange', setRoute);
    setRoute();

    (async function () {
      try {
        const res = await fetch('site-data.json', { cache: 'no-store' });
        if (!res.ok) throw new Error('Failed to load site-data.json');
        const data = await res.json();

        // Populate Board
        const boardBody = document.getElementById('board-rows');
        if (boardBody && Array.isArray(data.board)) {
          boardBody.innerHTML = '';
          for (const m of data.board) {
            const tr = document.createElement('tr');

            const tdName = document.createElement('td');
            tdName.textContent = m.name || '';
            tr.appendChild(tdName);

            const tdPos = document.createElement('td');
            tdPos.textContent = m.position || '';
            tr.appendChild(tdPos);

            const tdTerm = document.createElement('td');
            tdTerm.textContent = m.termEnds || '';
            tr.appendChild(tdTerm);

            boardBody.appendChild(tr);
          }
        }

        // Populate Committees (by slug → tbody id="committee-${slug}")
        if (Array.isArray(data.committees)) {
          for (const c of data.committees) {
            const tbody = document.getElementById(`committee-${c.slug}`);
            if (!tbody) continue;
            tbody.innerHTML = '';
            (c.members || []).forEach(member => {
              const tr = document.createElement('tr');
              const td = document.createElement('td');
              td.textContent = member;
              tr.appendChild(td);
              tbody.appendChild(tr);
            });
          }
        }
      } catch (err) {
        console.error('[Data load error]', err);
        // Optional: show a small inline message if data fails to load
        document.querySelectorAll('tbody').forEach(tb => tb.innerHTML = '<tr><td>Data unavailable</td></tr>');
      }
    })();

    // Copy link interaction
    (function () {
      const copyBtn = document.getElementById('copy-ical');
      const linkEl = document.getElementById('calendar-link');
      const copiedEl = document.getElementById('copied-msg');
      if (!copyBtn || !linkEl) return;
      copyBtn.addEventListener('click', async () => {
        const text = linkEl.textContent.trim();
        try {
          await navigator.clipboard.writeText(text);
        } catch (e) {
          const ta = document.createElement('textarea');
          ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
        }
        copiedEl.style.display = 'inline';
        setTimeout(() => copiedEl.style.display = 'none', 1500);
      });
    })();

    // Make the header image clickable
    document.getElementById("main-header").addEventListener("click", function (e) {
      // Prevent clicks inside .portal-inner from triggering
      if (!e.target.closest(".portal-inner")) {
        location.hash = "#banner";
      }
    });

    // Stamp table cells with data-label attributes for mobile styling
    function stampTableLabels(root = document) {
      root.querySelectorAll('table:not([data-mobile-labels="off"])').forEach(table => {

        // Skip opt-out tables
        if (table.matches('.no-mobile-stack,[data-mobile-labels="off"]')) return;

        const heads = Array.from(table.querySelectorAll('thead th')).map(th => th.textContent.trim());
        if (!heads.length) return;

        table.querySelectorAll('tbody tr').forEach(tr => {
          const cells = tr.querySelectorAll('td');
          cells.forEach((td, i) => {
            if (!td.hasAttribute('data-label') && heads[i]) {
              td.setAttribute('data-label', heads[i]);
            }
          });
        });
      });
    }

    // Run once on load
    document.addEventListener('DOMContentLoaded', () => stampTableLabels());

    // Also catch rows added later (e.g., when you populate from JSON)
    const mo = new MutationObserver(() => stampTableLabels());
    mo.observe(document.body, { childList: true, subtree: true });
  </script>
</body>

</html>